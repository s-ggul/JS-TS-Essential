## Hacker News 마이그레이션 공부 내용

---

- 이전 구현한 Hacker News 웹을 타입스크립트로 전환하는 작업을 한다.
- 보통 이런 류의 작업을 예전에는 `포팅`이라고 하였다. => A 언어로 된 작업을 B언어로 변환하는 작업
- `포팅`이라는 말을 요즘 잘 사용하지도 않지만 `포팅`에 더 가깝다.

### 초기 환경 설정
- 기존 작성했던 index.html 내 `<script>` 태그에 있는 `app.js` 를 `app.ts`로 변경한다. 
- 또한 `app.js` 파일명을 `app.ts`로 변경한다.
- 추가적으로 타입스크립트를 사용해 앱을 변환할 것이기 때문에 `tsconfig.js` 라는 파일이 더 필요하다.
  - `타입스크립트`는 실제로 `트랜스 파일러`여서 브라우저에서 실행시키려면 자바스크립트로 변환을 해야하는데 이 과정에서 여러가지 옵션을 줄 수 있다. 타입스크립트에선 이 과정을 `컴파일`이라고 부르고 이 컴파일하는 과정에 여러가지 옵션들을 줘서 타입스크립트의 기능이 어떻게 활성화되고 어떤 기능들은 비활성화 시킬지, 어떤 것들은 강력하게 적용하고 소프트하게 적용할지 굉장히 많은 옵션들이 있는데 이런 것들을 `tsconfig.json` 파일에 설정해서 사용할 수 있다. => 다양한 옵션들은 공식문서에 나와있다.

```json
{
    "compilerOptions": {
        "strict": true, 
        // 타입스크립트의 기능을 얼마나 엄격하게 적용해서 변환시킬 것인지의 유무이다. 
        // 타입스크립트가 제공하는 가장 핵심적인 기능은 자바스크립트 타입 확장 구문을 제공하는 것이다.
        // false 인 경우에는 타입스크립트와 js를 혼용할 수 있지만 true이면 타이핑이 필요한 곳에서는 타입을 정해줘야한다.
        
        "target": "ES5",
        "module": "CommonJS",
        // 타입스크립트를 나중에 컴파일하게 되면 JS 파일이 나오게 되는데, 
        // 그 JS 파일에 사용되는 문법체계를 어떤 문법체계를 쓸 것이냐를 "target"에 명시하고
        // "module" 에는 이 항목은 모듈과 관련된 부분인데 후에 더 설명한다. 현재 CommonJS는 디폴트 값이다.

        "alwaysStrict": true,
        "noImplicitAny": true,
        // strict 모드 하위에 있는 세부 옵션들로 엄격한 옵션들 중에서도 특별한 옵션들이다. 이렇게 세부 옵션을 끄고 켤 수 있다. 
        // js 에서 ts로 변환될때 타입스크립트에서는 이 타입이 어떤 타입인지 알기 어렵기 때문에 기본적으로 어떤 타입이든 다 된다 라는 의미에서 Any라는 타입을 가지는데, 
        // noImplicitAny 옵션을 통해 Any를 쓰지못하게 해서 명확하게 타입을 기술 할수 있도록 하는 옵션을 제공한다.
        "noImplicitThis": true,
        "sourceMap": true,
        "downlevelIteration": true
    }
}

// 후에 더 필요한 옵션들은 ts컴파일러 옵션 문서에서 찾아보고 알아보자.
```

#### tsconfig.json 파일 내 sourceMap 옵션
- `tsconfig.json` 파일 내에는 `sourceMap`이라는 옵션이 존재한다.
- `HackerNews마이그레이션` 디렉터리 내에 생성된 `dist`라고 하는 디렉터리가 존재한다. 
- `dist` 디렉터리는 타입스크립트 컴파일러가 타입스크립트를 변환한 결과를 출력해 놓은 타겟 디렉터리이다.
- 그래서 내부를 보면 `app??.js`라는 파일과 `app??.js.map` 그리고 `index.html` 파일이 존재한다.
- 그리고 `index.html` 을 열어보면 `<script>` 태그 내에 `src` 가 `app??.js` 를 로드하는 것을 확인할 수 있다.
- 우리가 개발한 파일은 `.ts`파일이지만 js로 변환한 결과가 저장된 것이다. 
- `js.map`이라는 확장자를 가진 파일은 `sourceMap`이라는 파일인데 이는 브라우저에서 이 앱을 실행했을때 개발한 코드가 타입스크립트라면 브라우저가 알지 못한다. => 브라우저가 아는 언어는 자바스크립트이다.
- 코드는 타입스크립트로 작성하고, 실제 실행은 브라우저에서 자바스크립트로 하는 경우 만일 코드에 문제가 발생하면 타입스크립트 코드를 변환한 자바스크립트 파일로 문제를 발견하기란 쉽지 않다. => 우리가 작성한 코드와 다르니까
- 그럴때 실제 브라우저에서 우리가 작성한 원본 코드(타입스크립트 코드)를 보여주면서 그 상태에서 문제점을 찾을 수 있게, 실제 내부적으로 실행은 자바스크립트로 되지만, 그런 기능들을 제공해주기 위한 일종의 `연결 정보`를 가지고 있는 파일이라고 보면 된다. 
- 따라서 `이러한 sourceMap 파일을 생성해라 사용할거다` 라는 옵션이 `tsconfig.json` 내의 `sourceMap`옵션인 것이다.
- `sourceMap`이라 함은 소스의 지도 같은 것이다.
- 실제 브라우저에서 검사창을 열고 `source 탭`에서 `.js`파일도 나타나지만 `.ts`파일도 나타난다. 이렇게 `.ts`파일에서 문제가 발생했을때 브라우저에서도 확인할 수 있고, 이로인해 `실행환경과 개발환경을 일치`시킬 수 있는 편리함을 얻을 수 있는 옵션인 것이다.